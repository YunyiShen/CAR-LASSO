<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • CARlasso</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="CARlasso">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CARlasso</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/network.html">Get started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started</h1>
            
      
      
      <div class="hidden name"><code>network.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CARlasso</span><span class="op">)</span></code></pre></div>
<div id="network-for-gaussian-data" class="section level2">
<h2 class="hasAnchor">
<a href="#network-for-gaussian-data" class="anchor"></a>Network for Gaussian data</h2>
<p>This is the case when data is Gaussian or can be transformed to Gaussian, for instance (log) biomass of trees, we will give a simuated example. The use of the <code>Carlasso</code> is similar to <code>lm</code>, we could supply a formula and a dataframe with both responses and predictors:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simu_AR1.html">simu_AR1</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,k<span class="op">=</span><span class="fl">5</span>, rho<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span>
<span class="co">#&gt;           y1          y2         y3         y4         y5         x1         x2</span>
<span class="co">#&gt; 1  1.2705558  0.94046103 -0.9356549 -0.5202384 -0.1928792  1.3709584  1.2009654</span>
<span class="co">#&gt; 2  0.6027324  0.06671259  0.9096216  1.3740787  0.9584424 -0.5646982  1.0447511</span>
<span class="co">#&gt; 3 -0.1139447 -1.61460997 -0.1140354 -0.8013874  0.4673093  0.3631284 -1.0032086</span>
<span class="co">#&gt; 4  0.5912523  2.13482891  2.2626483  1.8791249  2.3825324  0.6328626  1.8484819</span>
<span class="co">#&gt; 5 -2.1837420 -3.68267385 -2.3069358 -3.6243897 -2.2644276  0.4042683 -0.6667734</span>
<span class="co">#&gt; 6 -2.2367855 -1.92498967 -3.2242525 -1.5495283 -1.4191343 -0.1061245  0.1055138</span>
<span class="co">#&gt;           x3           x4          x5</span>
<span class="co">#&gt; 1 -2.0009292 -0.004620768  1.33491259</span>
<span class="co">#&gt; 2  0.3337772  0.760242168 -0.86927176</span>
<span class="co">#&gt; 3  1.1713251  0.038990913  0.05548695</span>
<span class="co">#&gt; 4  2.0595392  0.735072142  0.04906691</span>
<span class="co">#&gt; 5 -1.3768616 -0.146472627 -0.57835573</span>
<span class="co">#&gt; 6 -1.1508556 -0.057887335 -0.99873866</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">car_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CARlasso.html">CARlasso</a></span><span class="op">(</span><span class="va">y1</span><span class="op">+</span><span class="va">y2</span><span class="op">+</span><span class="va">y3</span><span class="op">+</span><span class="va">y4</span><span class="op">+</span><span class="va">y5</span><span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span><span class="op">+</span><span class="va">x4</span><span class="op">+</span><span class="va">x5</span>, data <span class="op">=</span> <span class="va">dt</span>, adaptive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Predictors will be centered.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adapive. Assuming all hyper parameters are the same for beta </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adapive. Assuming all hyper parameters are the same for Omega's off diagonal entries </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adaptive. Assuming priors are all the same for Omega's diagonals </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm start...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; progress:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; done</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">car_res</span>,tol <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<p><img src="network_files/figure-html/ar1example_first-1.png" width="700"></p>
<p>We can have a more formal horseshoe inference on the structure of the network, this will update the <code>car_res</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># with horseshoe inference</span>
<span class="va">car_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/horseshoe.html">horseshoe</a></span><span class="op">(</span><span class="va">car_res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">car_res</span><span class="op">)</span></code></pre></div>
<p><img src="network_files/figure-html/horseshoe_1-1.png" width="700"></p>
</div>
<div id="network-for-compositional-data" class="section level2">
<h2 class="hasAnchor">
<a href="#network-for-compositional-data" class="anchor"></a>Network for compositional data</h2>
<p>This is common in microbe related studies and some ecological applications with relative abundance only. For instance, microbe relative abundance came from sequencing and in this case we will have the sum of “abundance” decided by the sequence depth rather than the real total abundance. The data is usually described as “compositional”. In <code>CARlasso</code> this type of data were modelled as Logit-Normal-multinomial. In this case, we have less relative abundance need to have a “reference level” taxa and all others are “relative” to this taxa, we will give a reduced version:</p>
<p>Have a look of the data, still a dataframe with all predictors and responses</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mgp154</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>
<span class="co">#&gt;      id Alistipes Bacteroides Barnesiella Blautia Butyrivibrio Caloramator</span>
<span class="co">#&gt; 1 EM245        42        2101           0     334           61         156</span>
<span class="co">#&gt; 2 EM109      2910        6080          40     597          178         175</span>
<span class="co">#&gt; 3 EM248      2850        5392           0     327           46          87</span>
<span class="co">#&gt; 4 EM274      1559        7210          43    1206           50         428</span>
<span class="co">#&gt; 5 EM330      1916        5067           0    1827           64        5847</span></code></pre></div>
<p>To run the composition model, we need to set <code>link="logit"</code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CARlasso.html">CARlasso</a></span><span class="op">(</span><span class="va">Alistipes</span><span class="op">+</span><span class="va">Bacteroides</span><span class="op">+</span>
                        <span class="va">Eubacterium</span><span class="op">+</span><span class="va">Parabacteroides</span><span class="op">+</span><span class="va">all_others</span><span class="op">~</span>
                        <span class="va">BMI</span><span class="op">+</span><span class="va">Age</span><span class="op">+</span><span class="va">Gender</span><span class="op">+</span><span class="va">Stratum</span>,
                    data <span class="op">=</span> <span class="va">mgp154</span>,link <span class="op">=</span> <span class="st">"logit"</span>, 
                    adaptive <span class="op">=</span> <span class="cn">TRUE</span>, n_iter <span class="op">=</span> <span class="fl">2000</span>, 
                    n_burn_in <span class="op">=</span> <span class="fl">1000</span>, thin_by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Predictors will be centered.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adapive. Assuming all hyper parameters are the same for beta </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adapive. Assuming all hyper parameters are the same for Omega's off diagonal entries </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adaptive. Assuming priors are all the same for Omega's diagonals </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Last response will be used as reference group</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm start...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; progress:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; done</span></code></pre></div>
<p>Note that in this case <code>all_others</code>, i.e. the last one in the left hand side of the formula will be the reference level.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># horseshoe will take a while, as it needs to sample the latent normal too</span>
<span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/horseshoe.html">horseshoe</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span></code></pre></div>
<p><img src="network_files/figure-html/horseshoe_comp-1.png" width="700"></p>
</div>
<div id="network-for-counting-data" class="section level2">
<h2 class="hasAnchor">
<a href="#network-for-counting-data" class="anchor"></a>Network for counting data</h2>
<p>This is common in a lot of ecological applications. For instance number of seedlings within a site. The responses were count rather than continuous. In <code>CARlasso</code> it is modelled as Poisson with rate follow log-Normal. We will give the example using the data above since the responses are indeed count, but keep in mind we need to be careful whether a couting data is real counting or compositional. To distinguish them, ask the question: <strong>Is the sum know/decided by us/not free</strong>?</p>
<p>To run the composition model, we need to set <code>link="log"</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CARlasso.html">CARlasso</a></span><span class="op">(</span><span class="va">Alistipes</span><span class="op">+</span><span class="va">Bacteroides</span><span class="op">+</span>
                        <span class="va">Eubacterium</span><span class="op">+</span><span class="va">Parabacteroides</span><span class="op">+</span><span class="va">all_others</span><span class="op">~</span>
                        <span class="va">BMI</span><span class="op">+</span><span class="va">Age</span><span class="op">+</span><span class="va">Gender</span><span class="op">+</span><span class="va">Stratum</span>,
                    data <span class="op">=</span> <span class="va">mgp154</span>,link <span class="op">=</span> <span class="st">"log"</span>, 
                    adaptive <span class="op">=</span> <span class="cn">TRUE</span>, 
                    r_beta <span class="op">=</span> <span class="fl">0.1</span>, <span class="co"># default sometimes cause singularity in Poisson model due to exponential transformation, slightly change can fix it.</span>
                    n_iter <span class="op">=</span> <span class="fl">2000</span>, 
                    n_burn_in <span class="op">=</span> <span class="fl">1000</span>, thin_by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Predictors will be centered.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adapive. Assuming all hyper parameters are the same for beta </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adapive. Assuming all hyper parameters are the same for Omega's off diagonal entries </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm set to be adaptive. Assuming priors are all the same for Omega's diagonals </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm start...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; progress:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; done</span>
<span class="co"># horseshoe will take a while, as it's currently implemented in R rather than C++</span>
<span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/horseshoe.html">horseshoe</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span></code></pre></div>
<p><img src="network_files/figure-html/counting-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://yunyishen.ml">Yunyi Shen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
