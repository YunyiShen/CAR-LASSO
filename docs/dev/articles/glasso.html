<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphical LASSO support • CARlasso</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Graphical LASSO support">
<meta property="og:description" content="CARlasso">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CARlasso</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/buildown.html">Build your own hierarchical model</a>
    </li>
    <li>
      <a href="../articles/glasso.html">Graphical LASSO support</a>
    </li>
    <li>
      <a href="../articles/network.html">Get started with CAR-LASSO models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/YunyiShen/CAR-LASSO/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Graphical LASSO support</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/YunyiShen/CAR-LASSO/blob/master/vignettes/glasso.Rmd"><code>vignettes/glasso.Rmd</code></a></small>
      <div class="hidden name"><code>glasso.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YunyiShen/CAR-LASSO">CARlasso</a></span><span class="op">)</span></code></pre></div>
<p>We also implemented the standard Graphical LASSO to infer a graph without predictors. The main interface is <code>bGlasso</code>. For more details, please see the <a href="https://yunyishen.ml/CAR-LASSO/dev/reference/bGlasso.html">reference</a>.</p>
<div id="glasso-network-for-gaussian-data" class="section level2">
<h2 class="hasAnchor">
<a href="#glasso-network-for-gaussian-data" class="anchor"></a>GLASSO Network for Gaussian data</h2>
<p>This is the case when data is Gaussian or can be transformed to Gaussian. We only need responses in this case. We use a 5-node AR1 model to simulate data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simu_AR1.html">simu_AR1</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,k<span class="op">=</span><span class="fl">5</span>, rho<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span>
<span class="co">#&gt;           y1          y2         y3         y4         y5</span>
<span class="co">#&gt; 1  1.2705558  0.94046103 -0.9356549 -0.5202384 -0.1928792</span>
<span class="co">#&gt; 2  0.6027324  0.06671259  0.9096216  1.3740787  0.9584424</span>
<span class="co">#&gt; 3 -0.1139447 -1.61460997 -0.1140354 -0.8013874  0.4673093</span>
<span class="co">#&gt; 4  0.5912523  2.13482891  2.2626483  1.8791249  2.3825324</span>
<span class="co">#&gt; 5 -2.1837420 -3.68267385 -2.3069358 -3.6243897 -2.2644276</span>
<span class="co">#&gt; 6 -2.2367855 -1.92498967 -3.2242525 -1.5495283 -1.4191343</span></code></pre></div>
<p>Unlike <code>CARlasso</code>, we do not really need to have a formula (because we do not have predictors, only responses). To use the Normal version, we should set <code>link="identity"</code> which is the default.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glassores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bGlasso.html">bGlasso</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span>
<span class="co">#&gt; Algorithm start...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; progress:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; done</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">glassores</span><span class="op">)</span></code></pre></div>
<p><img src="glasso_files/figure-html/ar1example_first-1.png" width="700"></p>
<p>Some of the connections are actually due to predictors.</p>
</div>
<div id="glasso-network-for-compositional-data" class="section level2">
<h2 class="hasAnchor">
<a href="#glasso-network-for-compositional-data" class="anchor"></a>GLASSO Network for compositional data</h2>
<p>This is common in the case of microbe-related studies and some ecological applications with relative abundances. For instance, microbe relative abundance come from sequencing and in this case, the sum of “abundance” is determined by the sequence depth rather than the real total abundance. The data is usually described as “compositional”.</p>
<p>We first extract only the responses that we want to include in the model:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">mgp154</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Alistipes"</span>,<span class="st">"Bacteroides"</span>,
                        <span class="st">"Eubacterium"</span>,<span class="st">"Parabacteroides"</span>,<span class="st">"all_others"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>To run the composition model in <code>bGlasso</code>, we need to set <code>link="logit"</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bGlasso.html">bGlasso</a></span><span class="op">(</span> data <span class="op">=</span> <span class="va">dt</span>,link <span class="op">=</span> <span class="st">"logit"</span>, 
                    n_iter <span class="op">=</span> <span class="fl">2000</span>, 
                    n_burn_in <span class="op">=</span> <span class="fl">1000</span>, thin_by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Last response will be used as reference group</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Algorithm start...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; progress:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; done</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span></code></pre></div>
<p><img src="glasso_files/figure-html/compositional1-1.png" width="700"></p>
<p>Note that in this case the last one in the dataframe will be the reference level (<code>all_others</code> in this case).</p>
</div>
<div id="glasso-network-for-counting-data" class="section level2">
<h2 class="hasAnchor">
<a href="#glasso-network-for-counting-data" class="anchor"></a>GLASSO Network for counting data</h2>
<p>This is common in a lot of ecological applications. For instance, number of seedlings within a site. The responses are counts rather than continuous. We will use the same compositional data as before to illustrate the counts model. However, it is important to note that relative abundances should not be considered as counts. To distinguish between compositional and count data, one can ask the question: <strong>is the sum decided by us?</strong> If yes, we want to use compositional models.</p>
<p>To run the count model, we need to set <code>link="log"</code>. Note that we only include the first 4 responses:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bGlasso.html">bGlasso</a></span><span class="op">(</span> data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,link <span class="op">=</span> <span class="st">"log"</span>, 
                    n_iter <span class="op">=</span> <span class="fl">2000</span>, 
                    n_burn_in <span class="op">=</span> <span class="fl">1000</span>, thin_by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Algorithm start...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; progress:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; done</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span></code></pre></div>
<p><img src="glasso_files/figure-html/counting-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://yunyishen.ml">Yunyi Shen</a>, <a href="https://solislemuslab.github.io/">Claudia Solis-Lemus</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
