<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Conditional AutoRegressive LASSO â€¢ CARlasso</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Conditional AutoRegressive LASSO">
<meta property="og:description" content="Algorithms to fit Bayesian Conditional Auto Regressive LASSO with automatic and adaptive shrinkage by Shen and Solis-Lemus 2020 &lt;arXiv:2012.08397&gt;.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CARlasso</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/buildown.html">Build your own hierarchical model</a>
    </li>
    <li>
      <a href="articles/glasso.html">Graphical LASSO support</a>
    </li>
    <li>
      <a href="articles/network.html">Get started with CAR-LASSO models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/YunyiShen/CAR-LASSO/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><img src="https://github.com/YunyiShen/CAR-LASSO/workflows/R-CMD-check/badge.svg"></p>
<div id="carlasso-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#carlasso-" class="anchor"></a>CARlasso <a href="https://yunyishen.github.io/CAR-LASSO/dev"><img src="https://github.com/YunyiShen/CAR-LASSO/raw/dev/CARlasso.png" align="right" height="110"></a>
</h1></div>
</div>
<div id="carlasso-conditional-auto-regressive-lasso-in-r" class="section level1">
<h1 class="hasAnchor">
<a href="#carlasso-conditional-auto-regressive-lasso-in-r" class="anchor"></a>CARlasso: Conditional Auto-Regressive LASSO in R</h1>
<p>With this package, users can infer a graph with two types of nodes: 1) for correlated responses (for example, microbial abundances) and 2) for predictors affecting the responses (for example, environmental or experimental conditions).</p>
<p>The advantages of our implementation is that:</p>
<ol>
<li>The edges in the graph correspond to conditional dependency (instead of marginal) which agree better with the biological intution behind experiments</li>
<li>The graph is sparse</li>
<li>Because the implementation is Bayesian, users can incorporate prior knowledge into the model</li>
</ol>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The package is not yet on CRAN, so to install it, please use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"YunyiShen/CAR-LASSO"</span><span class="op">)</span></code></pre></div>
<p><strong>Dependencies:</strong> The CAR-LASSO R package depends on the following R packages: <code>Rcpp</code>, <code>RcppArmadillo</code>, <code>RcppProgress</code>, <code>coda</code>, <code>Matrix</code>, <code>igraph</code>, <code>ggraph</code>, and <code>ggplot2</code>.</p>
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h2>
<p>For more information, please check out <a href="https://yunyishen.ml/CAR-LASSO/dev/articles/network.html">the tutorial</a>.</p>
<div id="fitting-a-car-alasso-network-on-human-gut-microbiome-data" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-a-car-alasso-network-on-human-gut-microbiome-data" class="anchor"></a>Fitting a CAR-ALASSO network on human gut microbiome data</h3>
<p>To run a reduced version of the analysis on human gut microbiome in our paper (with less predictors and responses):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YunyiShen/CAR-LASSO">CARlasso</a></span><span class="op">)</span>
<span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CARlasso.html">CARlasso</a></span><span class="op">(</span><span class="va">Alistipes</span><span class="op">+</span><span class="va">Bacteroides</span><span class="op">+</span>
                        <span class="va">Eubacterium</span><span class="op">+</span><span class="va">Parabacteroides</span><span class="op">+</span><span class="va">all_others</span><span class="op">~</span>
                        <span class="va">BMI</span><span class="op">+</span><span class="va">Age</span><span class="op">+</span><span class="va">Gender</span><span class="op">+</span><span class="va">Stratum</span>,
                    data <span class="op">=</span> <span class="va">mgp154</span>,link <span class="op">=</span> <span class="st">"logit"</span>, 
                    adaptive <span class="op">=</span> <span class="cn">TRUE</span>, n_iter <span class="op">=</span> <span class="fl">5000</span>, 
                    n_burn_in <span class="op">=</span> <span class="fl">1000</span>, thin_by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co"># horseshoe will take a while, as it needs to sample the latent normal too</span>
<span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/horseshoe.html">horseshoe</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span></code></pre></div>
<p>It might take a little while due to the sampling process of the latent normal variable.</p>
<p>We are using the sample human gut microbiome data included in the package (<code>mgp154</code>). If you want to run this model on your own data, check out the structure of <code>mgp154</code> to put your data in the same format:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mgp154</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mgp154</span><span class="op">)</span></code></pre></div>
<p>The color of the edge represents the type of correlation (negative=blue, positive=red) and the width of the edge corresponds to the effect size. Response nodes are represented by circles (in this case, microbes) and predictor nodes are represented by triangles (in this case, age, gender, and stratum).</p>
<p><img src="http://YunyiShen.github.io/files/Research_figs/CARLASSO/human_gut_reduce.png" alt="The Result"></p>
<p>Though we donâ€™t recommend treating compositional data as counts, as a illustration, we can run the counting model (<code>link = "log"</code>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CARlasso.html">CARlasso</a></span><span class="op">(</span><span class="va">Alistipes</span><span class="op">+</span><span class="va">Bacteroides</span><span class="op">+</span>
                        <span class="va">Eubacterium</span><span class="op">+</span><span class="va">Parabacteroides</span><span class="op">+</span><span class="va">all_others</span><span class="op">~</span>
                        <span class="va">BMI</span><span class="op">+</span><span class="va">Age</span><span class="op">+</span><span class="va">Gender</span><span class="op">+</span><span class="va">Stratum</span>,
                    data <span class="op">=</span> <span class="va">mgp154</span>,link <span class="op">=</span> <span class="st">"log"</span>, 
                    adaptive <span class="op">=</span> <span class="cn">TRUE</span>, 
                    r_beta <span class="op">=</span> <span class="fl">0.1</span>, <span class="co"># default sometimes cause singularity in Poisson model due to exponential transformation, slightly change can fix it.</span>
                    n_iter <span class="op">=</span> <span class="fl">5000</span>, 
                    n_burn_in <span class="op">=</span> <span class="fl">1000</span>, thin_by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co"># horseshoe will take a while, as it's currently implemented in R rather than C++</span>
<span class="va">gut_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/horseshoe.html">horseshoe</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">gut_res</span><span class="op">)</span></code></pre></div>
<p><img src="http://YunyiShen.github.io/files/Research_figs/CARLASSO/gut_count.png" alt="The Result"></p>
</div>
<div id="fitting-a-car-alasso-network-on-simulated-data" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-a-car-alasso-network-on-simulated-data" class="anchor"></a>Fitting a CAR-ALASSO network on simulated data</h3>
<p>We generate data from a 5-node AR1 model where each node has a specific treatment. Then, we use the adaptive version of CAR-LASSO (CAR-ALASSO) to reconstruct such network and plot the result:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simu_AR1.html">simu_AR1</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, k<span class="op">=</span><span class="fl">5</span>, rho<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>
<span class="va">car_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CARlasso.html">CARlasso</a></span><span class="op">(</span><span class="va">y1</span><span class="op">+</span><span class="va">y2</span><span class="op">+</span><span class="va">y3</span><span class="op">+</span><span class="va">y4</span><span class="op">+</span><span class="va">y5</span><span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span><span class="op">+</span><span class="va">x4</span><span class="op">+</span><span class="va">x5</span>, data <span class="op">=</span> <span class="va">dt</span>, adaptive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">car_res</span>,tol <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co"># with horseshoe inference</span>
<span class="va">car_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/horseshoe.html">horseshoe</a></span><span class="op">(</span><span class="va">car_res</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">car_res</span><span class="op">)</span></code></pre></div>
<p><img src="http://YunyiShen.github.io/files/Research_figs/CARLASSO/package_eg.png" alt="The Result"></p>
</div>
<div id="fitting-a-standard-graphical-lasso-network" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-a-standard-graphical-lasso-network" class="anchor"></a>Fitting a standard Graphical LASSO network</h3>
<p>Our package also includes functions to fit a standard graphical LASSO, see <a href="https://yunyishen.ml/CAR-LASSO/dev/articles/glasso.html">this page</a> in the tutorial for more details.</p>
</div>
<div id="fitting-your-own-hierarchical-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-your-own-hierarchical-model" class="anchor"></a>Fitting your own hierarchical model</h3>
<p>If you would like lower level interface of CAR-LASSO, see <a href="https://yunyishen.ml/CAR-LASSO/dev/articles/buildown.html">this page</a> in the tutorial.</p>
</div>
</div>
<div id="contributions" class="section level2">
<h2 class="hasAnchor">
<a href="#contributions" class="anchor"></a>Contributions</h2>
<p>Users interested in expanding functionalities in CAR-LASSO R package are welcome to do so. See details on how to contribute in <a href="https://github.com/YunyiShen/CAR-LASSO/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a>.</p>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>CAR-LASSO R package is licensed under the <a href="https://github.com/YunyiShen/CAR-LASSO/blob/master/LICENSE">GNU General Public License v3.0</a> license.</p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>If you use the CAR-LASSO R package in your work, we kindly ask that you cite the following paper:</p>
<p>Shen, Y., SolÃ­s-Lemus, C. (2020). Bayesian Conditional Auto-Regressive LASSO Models to Learn Sparse Networks with Predictors, <a href="https://arxiv.org/abs/2012.08397">arXiv:2012.08397</a></p>
<pre><code>@article{Shen2020,
  title         = "Bayesian Conditional {Auto-Regressive} {LASSO} Models to
                   Learn Sparse Networks with Predictors",
  author        = "Shen, Yunyi and Solis-Lemus, Claudia",
  month         =  dec,
  year          =  2020,
  archivePrefix = "arXiv",
  primaryClass  = "stat.AP",
  eprint        = "2012.08397"
}</code></pre>
</div>
</div>
<div id="feedback-issues-and-questions" class="section level1">
<h1 class="hasAnchor">
<a href="#feedback-issues-and-questions" class="anchor"></a>Feedback, issues and questions</h1>
<p>Feedback, issues and questions are encouraged through the <a href="https://github.com/YunyiShen/CAR-LASSO/issues">GitHub issue tracker</a>.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/YunyiShen/CAR-LASSO/">https://â€‹github.com/â€‹YunyiShen/â€‹CAR-LASSO/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/YunyiShen/CAR-LASSO/issues">https://â€‹github.com/â€‹YunyiShen/â€‹CAR-LASSO/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://yunyishen.ml">Yunyi Shen</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2779-6507" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://solislemuslab.github.io/">Claudia Solis-Lemus</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-9789-8915" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://yunyishen.ml">Yunyi Shen</a>, <a href="https://solislemuslab.github.io/">Claudia Solis-Lemus</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
